# CI output from these examples are available here:
# https://github.com/gaggle/elixir_script/actions/workflows/examples.yml?query=branch%3Amain
#
# ℹ️ This file is automatically generated via `mix e2e.update_examples_workflow`

name: Examples

on:
  push:
    paths:
      - .github/workflows/examples.yml
  release:
    types:
      - "created"
  workflow_dispatch:

jobs:
  scripts-are-run-and-what-it-returns-is-available-via-outputs:
    runs-on: ubuntu-latest
    steps:
      - uses: gaggle/elixir_script@v0
        id: script
        with:
          script: |
            defmodule Foo do
              def bar, do: "bar"
            end
            Foo.bar()

      - name: Get result
        run: echo "${{steps.script.outputs.result}}"

  io-is-visible-in-logs:
    runs-on: ubuntu-latest
    steps:
      - uses: gaggle/elixir_script@v0
        id: script
        with:
          script: |
            IO.puts("Hello world")

      - name: Get result
        run: echo "${{steps.script.outputs.result}}"

  event-context-is-available:
    runs-on: ubuntu-latest
    steps:
      - uses: gaggle/elixir_script@v0
        id: script
        with:
          script: |
            IO.inspect(context)
            Map.keys(context) |> Enum.sort

      - name: Get result
        run: echo "${{steps.script.outputs.result}}"

  multiline-scripts-are-possible:
    runs-on: ubuntu-latest
    steps:
      - uses: gaggle/elixir_script@v0
        id: script
        with:
          script: |
            IO.puts("Hello world")
            "result"

      - name: Get result
        run: echo "${{steps.script.outputs.result}}"

  oh-hi-mark-greeter:
    runs-on: ubuntu-latest
    steps:
      - uses: gaggle/elixir_script@v0
        id: script
        with:
          script: |
            defmodule Greeter do
              def greet(name), do: "Oh hi #{name}!"
            end
            Greeter.greet("Mark")

      - name: Get result
        run: echo "${{steps.script.outputs.result}}"
